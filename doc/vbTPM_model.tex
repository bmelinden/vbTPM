\subsection{Diffusive hidden Markov model}
We model the looping dynamics by a discrete Markov process $s_t$ with
$N$ states, a transition probability matrix $\matris{A}$, and initial
state distribution $\vec{\pi}$,
\begin{equation}\label{eq:eoms}
  p(s_t|s_{t-1},\matris{A})=A_{s_{t-1}s_t},\quad p(s_1)=\pi_{s_t}.
\end{equation}
This is the standard hidden part of an HMM, and the physics of TPM
goes into the emission model, that describes the restricted Brownian
motion of the bead. We use a discrete time model of over-damped 2D
diffusion in a harmonic potential, that has been suggested as a
simplified model for TPM \cite{beausang2007b,lindner2013},
\begin{equation}\label{eq:eomx}
  \x_t=K_{s_t}\x_{t-1}+\vec{w}_t/(2B_{s_t})^{1/2},
\end{equation}
where the index $s_t$ indicate parameters that depend on the hidden
state.  Thermal noise enters through the uncorrelated Gaussian random
vectors $\vec{w}_t$ with unit variance. The unintuitive
parametrization is chosen for computational convenience; $K_j$ and
$B_j$ are related to the spring and diffusion constant of the bead,
and some insight into their physical meaning can be gained by noting
that with a single hidden state, Eq.~\ref{eq:eomx} describes a
Gaussian process with zero mean and
\begin{align}
RMS&=\sqrt{\mean{\x^2}}=(B(1-K^2))^{-1/2},\nonumber\\
\frac{\mean{\x_{t+m}\cdot\x_t}}{\mean{\x^2}}&
=K^m\equiv e^{-m\Delta t/\tau},\label{eq:1state}
\end{align}
where $\Delta t$ is the sampling time, and $\tau$ is a bead
correlation time.  This model thus captures the diffusive character of
the bead motion, while still retaining enough simplicity to allow
efficient variational algorithms
\cite{mackay1997,bishop2006}.

\subsection{Factorial model}
\cite{vbTPM_model:describefactorialmodel}
