\documentclass[11pt,letterpaper,twocolumn]{article}
\usepackage[dvips]{graphicx}
\usepackage{fontspec}
\defaultfontfeatures{Ligatures=TeX}
\usepackage{amsmath}
\usepackage[numbers,sort&compress,round]{natbib}
\usepackage{url}
%\usepackage{epstopdf}
\usepackage{MLHMM}

\usepackage{color}
\usepackage[usenames,dvipsnames]{xcolor}
\newcommand{\jwm}[1]{\textcolor{MidnightBlue}{#1}}
\newcommand{\ml}[1]{\textcolor{BrickRed}{#1}}

\usepackage{ulem}
\newcommand{\del}[1]{\sout{#1}}

\newcommand{\comment}[1]{{\bf [#1]}}

\newcommand{\vbparbox}[1]{\parbox[t]{0.4\columnwidth}{
    \rule[5pt]{0pt}{5pt} #1 \rule[-3pt]{0pt}{5pt}}}


\title{vbTPM user guide and manual} 

\author{\ml{Martin Lind\'en}, Stephanie Johnson, \jwm{Jan-Willem van
    de Meent}, Rob Phillips, and Chris H Wiggins} 
\date{\today}

\begin{document}
\maketitle
\tableofcontents
% some information that is useful for running the VB7 software for
% analyzing TPM traces.

\section{Getting started with vbTPM}
\input{vbTPM_getstarted.tex}
\section{Diffusive model for TPM}
\input{vbTPM_model.tex}
\section{The VB-algorithm}
\input{vbTPM_algorithm.tex}
\subsection{Factorial model}
\subsection{Notation and symbols}\label{sec:notation}
\begin{table}
\caption{Fields in a model object named $W$.}
\begin{center}\begin{tabular}{|l|c|c|}
   \end{tabular}\end{center}\end{table}
\begin{table}
\caption{Representration of variational distributions for genuine
  states in a model object named $W$.}
\begin{center}\begin{tabular}{|l|c|c|}
    \hline
    field & symbol & Eq.\\
    \hline\hline
%    \verb+W.N+& \vbparbox{$N$, number of (genuine) states.}& \\
%    \hline
%    \verb+W.Nc+& \vbparbox{       
%      $N_c$, number of indicator states. $N_c=1$ means no spurious
%      states, i.e., the simple HMM.}& \eqref{eq:Nc}\\ \hline
%    \verb+W.PM+& \vbparbox{ Prior parameters for genuine states.}& \\ \hline

    \verb+W.M.wPi(j)+& $ w_j^{(\vec{\pi})}$    & \\ 
    \verb+W.PM.wPi(j)+& $\tilde w_j^{(\vec{\pi})}$    & \eqref{seq:VBMpi}\\ 
    \verb+W.E.ds_1(j)+& $\mean{\delta_{j,s_1}}$ & \\ 
    \hline
    
    \verb+W.PM.wA(i,j)+& $\tilde w_{ij}^{(\matris{A})}$& \\ 
    \verb+W.M.wA(i,j)+& $w_{ij}^{(\matris{A})}$& \eqref{seq:VBMAj}\\ 
    \verb+W.E.wA(i,j)+& $\sum_{t=2}^T\mean{\delta_{i,s_{t-1}}\delta_{j,s_t}}$
    & \\ 
    \hline
    \verb+W.PM.n(j)+& $\tilde n_j$& \eqref{seq:nj}\\ 
    \verb+W.M.n(j)+& $n_j$& \eqref{seq:nj}\\ 
    \verb+W.E.M(j)+& $M_j$& \eqref{seq:Mj}\\ 
    \hline
    \verb+W.PM.c(j)+& $\tilde c_j$& \eqref{seq:cj}\\ 
    \verb+W.M.c(j)+& $c_j$& \eqref{seq:cj}\\ 
    \verb+W.E.C(j)+& $C_j$&\eqref{seq:Cj}\\
    \hline
    \verb+W.PM.v(j)+& $\tilde v_j$& \eqref{seq:vj}\\ 
    \verb+W.M.v(j)+& $v_j$& \eqref{seq:vj}\\ 
    \verb+W.E.V(j)+& $V_j$& \eqref{seq:Vj}\\ 
    \hline
    \verb+W.PM.mu(j)+& $\tilde \mu_j$& \eqref{seq:muj}\\
    \verb+W.M.mu(j)+& $\mu_j$& \eqref{seq:muj}\\  
    \verb+W.E.U(j)+& $U_j$&\eqref{seq:Uj}\\
    \hline
  \end{tabular}\end{center}\end{table}
\begin{table}
\caption{Representration of variational distributions for indicator
  states $c_t$ in a model object named $W$. Fields relating to the
  emission model (.n, .c, .v, .mu, etc.) have the same meaning as for
  the genuine states $s_t$, except that their first element is not
  used, since $c_t=1$ indicate a genuine state.}
\begin{center}  
  \begin{tabular}{|l|c|c|}
    \hline
    field & symbol & Eq.\\
    \hline\hline
%
    \hline
    \verb+W.Mc.wPi(j)+& $w_j^{(\vec{\pi})}$    & \\ 
    \verb+W.PcM.wPi(j)+& $\tilde w_j^{(\vec{\pi})}$    & \eqref{seq:VBMcpi}\\ 
    \verb+W.Ec.ds_1(j)+& $\mean{\delta_{j,c_1}}$ & \\ 
    \hline
     \verb+W.PMc.wA(j)+& & \\ 
    \verb+W.Mc.wA(j)+& & \eqref{seq:VBMcAj}\\ 
    \verb+W.Ec.wA(j)+& &\\
    \hline
     \verb+W.PMc.wR(i,j)+& & \\ 
    \verb+W.Mc.wR(i,j)+& & \eqref{seq:VBMcRj}\\ 
    \verb+W.Ec.wR(i,j)+&& \\
    \hline
  \end{tabular}
\end{center}
\end{table}
   

\subsection{Large data sets}
Parallellization is achieved by running external scripts that starts
multiple independent Matlab runs, and use the presence of various~.mat
files to coordinate the computations. Repeated restarts of Matlab also
avoids problems with memory performance.

\subsection{Doing empirical Bayes}
Our empirical Bayes analysis of hierarchical models used tailored
scripts\ldots

\bibliographystyle{unsrtnat}
\bibliography{references}%,jwm_single_molecule,jwm_machine_learning}

\end{document}
